<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskPixel - 任务管理</title>
    <!-- 字体 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

    <!-- Tailwind CSS (CDN) and shared configuration -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="js/tailwind-config.js"></script>

    <!-- 应用样式 (带缓存版本号，方便强制刷新) -->
    <link rel="stylesheet" href="assets/css/styles.css?v=20250924">
    <!-- inline critical pixel styles (fallback for troubleshooting) -->
    <style>
        /* minimal critical styles to ensure pixel look while debugging external CSS load */
        .pixel-button {
            border: 4px solid #000;
            box-shadow: 4px 4px 0 #000;
            background: #4f46e5;
            color: #fff;
            padding: .5rem 1rem;
            display: inline-flex;
            align-items: center;
            gap: .5rem;
            font-weight: 700
        }

        .pixel-border {
            border: 4px solid #000;
            box-shadow: 4px 4px 0 #000;
            background: #fff;
            padding: 1rem
        }

        .pixel-card {
            border: 4px solid #000;
            box-shadow: 4px 4px 0 #000;
            background: #fff;
            padding: 1rem
        }
    </style>
</head>

<body class="bg-background-light font-display text-pixel-text-color">
    <div class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden">
        <div class="flex h-full grow flex-col">
            <header
                class="flex items-center justify-between whitespace-nowrap border-b-4 border-pixel-border-color px-6 py-4 bg-white">
                <div class="flex items-center gap-4">
                    <svg class="text-pixel-text-color" fill="none" height="32" viewBox="0 0 32 32" width="32"
                        xmlns="http://www.w3.org/2000/svg">
                        <path clip-rule="evenodd"
                            d="M0 0H8V8H0V0ZM8 8H16V16H8V8ZM16 16H24V24H16V16ZM0 16H8V24H0V16ZM8 24H16V32H8V24ZM16 0H24V8H16V0ZM24 8H32V16H24V8Z"
                            fill="currentColor" fill-rule="evenodd"></path>
                    </svg>
                    <h2 class="text-xl font-bold text-pixel-text-color">TaskPixel</h2>
                </div>
                <div class="hidden md:flex items-center gap-8 text-sm">
                    <a class="font-bold text-pixel-text-color nav-link active" href="index.html">主页</a>
                    <a class="text-black/70 hover:text-primary nav-link" href="calendar.html">日历</a>
                    <a class="text-black/70 hover:text-primary nav-link" href="goals.html">目标</a>
                    <a class="text-black/70 hover:text-primary nav-link" href="tags_management.html">标签管理</a>
                    <a class="text-black/70 hover:text-primary nav-link" href="settings.html">设置</a>
                    <a class="text-black/70 hover:text-primary nav-link" href="data_management.html">数据管理</a>
                </div>
                <!-- header right-side intentionally removed: notifications and avatar placeholders -->
            </header>
            <main class="w-full max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
                <div class="mb-10">
                    <h1 class="text-3xl font-bold mb-4">欢迎回来，<span class="username">Sarah</span>！</h1>
                    <div class="flex items-center gap-4">
                        <button
                            class="pixel-button bg-primary hover:bg-primary-hover text-white text-sm font-bold py-3 px-6 flex items-center gap-2 create-task-button">
                            <svg class="bi bi-plus-lg" fill="currentColor" height="16" viewBox="0 0 16 16" width="16"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2"
                                    fill-rule="evenodd"></path>
                            </svg>
                            <span>新任务</span>
                        </button>
                        <button
                            class="pixel-button bg-pixel-secondary text-pixel-text-color text-sm font-bold py-3 px-6 weekly-review-button">
                            <span>周报</span>
                        </button>
                    </div>
                </div>
                <div class="mb-12">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">我的任务</h2>
                            <p class="text-sm text-gray-600 mt-1">
                                <svg class="inline w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 16 16">
                                    <path
                                        d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z" />
                                </svg>
                                长按任务卡片可拖拽排序，右上角的点状图标表示可拖拽
                            </p>
                        </div>
                        <!-- 批量操作工具栏 -->
                        <div class="bulk-actions-toolbar hidden" id="bulkActionsToolbar">
                            <div class="flex items-center gap-4">
                                <span class="text-sm text-gray-600 selected-count">已选择 0 个任务</span>
                                <button
                                    class="pixel-button bg-red-500 hover:bg-red-600 text-white text-sm font-bold py-2 px-4 bulk-delete-btn">
                                    批量删除
                                </button>
                                <button
                                    class="pixel-button bg-gray-500 hover:bg-gray-600 text-white text-sm font-bold py-2 px-4 cancel-selection-btn">
                                    取消选择
                                </button>
                            </div>
                        </div>
                        <!-- 批量选择模式切换按钮 -->
                        <button
                            class="pixel-button bg-pixel-secondary text-pixel-text-color text-sm font-bold py-2 px-4 toggle-bulk-mode-btn">
                            批量管理
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 task-container">
                        <!-- 任务卡片将通过JavaScript动态生成 -->
                    </div>
                </div>
                <div>
                    <h2 class="text-2xl font-bold mb-6">下一步行动</h2>
                    <div class="space-y-6 next-actions-container">
                        <!-- 下一步行动建议将通过JavaScript动态生成 -->
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- 应用脚本 -->
    <!-- SortableJS for drag-and-drop ordering (loaded before page scripts) -->
    <script src="https://unpkg.com/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="js/core.js"></script>
    <script src="js/dataStoreAdapter.js"></script>
    <script src="js/aiAssist.js"></script>
    <script src="js/taskCreation.js"></script>
    <script src="js/home.js"></script>
    <script>
        // 初始化应用
        document.addEventListener('DOMContentLoaded', function () {
            // 初始化核心模块
            TaskPixel.init();

            // 初始化数据适配器（如果存在）
            if (TaskPixel.DataStoreAdapter && typeof TaskPixel.DataStoreAdapter.init === 'function') {
                TaskPixel.DataStoreAdapter.init();
            }

            // 初始化任务创建模块
            TaskPixel.TaskCreation.init();

            // 初始化主页模块
            TaskPixel.Home.init();

            // 更新用户名显示
            const settings = TaskPixel.DataStore.getSettings();
            const usernameElements = document.querySelectorAll('.username');
            usernameElements.forEach(element => {
                element.textContent = settings.username || 'Sarah';
            });

            // 更新头像（如果有）
            const avatarElements = document.querySelectorAll('.user-avatar');
            avatarElements.forEach(element => {
                // 这里可以根据用户设置更新头像
            });
        });
    </script>
</body>

</html>